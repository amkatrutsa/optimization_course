\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage[T2A]{fontenc}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage[top=2cm,bottom=2cm,left=2cm,right=2cm]{geometry}
\newcommand{\bx}{\mathbf{x}}
\newcommand{\bA}{\mathbf{A}}
\usepackage{indentfirst}
\usepackage{secdot}
\usepackage{color}

\title{Примеры решения задач линейного программирования симплекс-методом}
\author{Александр Катруца}
\date{}

\begin{document}
\maketitle
Здесь использованы материалы из книги~\cite{intro2lin}. 
\section{Задача 1}
Решить задачу табличным симплекс методом:
\begin{equation*}
\begin{split}
& \min_{\bx} -10x_1 - 12x_2 - 12x_3\\
\text{s.t. } & x_1 + 2x_2 +2x_3 \leq 20\\
& 2x_2 + x_2 + 2x_3 \leq 20\\
& 2x_1 + 2x_2 + x_3 \leq 20\\
& x_{1,2,3} \geq 0
\end{split}
\end{equation*}
\textbf{Решение:} по виду задачи ясно, что она не в канонической  форме. Введём дополнительные переменные и запишем её в канонической форме:
\begin{equation*}
\begin{split}
& \min_{\bx} -10x_1 - 12x_2 - 12x_3\\
\text{s.t. } & x_1 + 2x_2 +2x_3 + x_4 = 20\\
& 2x_2 + x_2 + 2x_3 + x_5 = 20\\
& 2x_1 + 2x_2 + x_3 + x_6 = 20\\
& x_{1,2,3,4,5,6} \geq 0
\end{split}
\end{equation*}
Заметим, что матрица $\bA \in \mathbb{R}^{m \times n}$, где $m=3$ и $n=6$.
Теперь нужно найти угловую точку допустимого множества, то есть такую точку, чтобы она лежала в множестве и существовало множество индексов $\mathcal{B} \subset \{1, \dots, n\}$ мощностью $|\mathcal{B}| = m = 3$, что матрица из столбцов матрицы $\bA$ с индексами из множества $\mathcal{B}$ была невырождена, и координаты угловой точки с индексами не из множества $\mathcal{B}$ были нулевыми.
В данном случае достаточно очевидно, что $\bx_0 = (0, 0, 0, 20, 20, 20)$, $\mathcal{B}_0 = \{4, 5, 6 \}$ и матрица базиса $\mathbf{B}_0 = \mathbf{I}_m$~--- невырождена.
Если начальная угловая точка не так очевидна, необходимо выполнить двухфазный симплекс-метод или M-метод. 
Такой пример будет приведён ниже.

Теперь составим таблицу~\ref{tab::simplex0} симплекс-метода, модифицируя которую получим решение поставленной задачи.
Столбцы этой таблицы соответствуют столбцам матрицы $\bA$. 
Последние $m=3$ строк соответствуют базисным переменным с индексами из множества~$\mathcal{B}_0$.
В $m+1$ строке с конца расположены оценки замещения для каждой переменной $x_i$, а в первом столбце отрицательное значение целевой функции.

\begin{table}[!ht]
\centering
\caption{Первоначальная таблица симплекс-метода}
\begin{tabular}{|c|cccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$\\
\hline
$-\mathbf{c}_{\mathcal{B}_0}^{\top}\bx_{\mathcal{B}_0} = 0$ & $-10$ & $-12$ & $-12$ & $0$ & $0$ & $0$ \\
\hline
$x_4 = 20$ & 1 & 2 & 2 & 1 & 0 & 0 \\
$x_5 = 20$ & \textbf{2} & 1 & 2 & 0 & 1 & 0 \\
$x_6 = 20$ & 2 & 2 & 1 & 0 & 0 & 1 \\
\hline
\end{tabular}
\label{tab::simplex0}
\end{table}
Выберем столбец, оценка замещения которого отрицательна и индекс котрого минимален.
Поэтому $j^* = 1$.
Тогда $\mathbf{u} = \mathbf{B}^{-1}_0\mathbf{a}_1 = \mathbf{a}_1.$
Так как $u_i > 0$ для $i= \in \{1,2,3\}$, то $\theta^* = 10$ и $\ell \in \{5, 6\}$.
В соответствии с правилом Бранда выберем $\ell = 5$.
Таким образом, выбран ведущий элемент равный 2, он выделен жирным в таблице~\ref{tab::simplex0}.

Далее с помощью элементарных преобразований получим базисную матрицу для новой угловой точки с базисом $\mathcal{B}_1 = \{4, 1, 6\}$. 
Прежде всего покажем, как изменится значение целевой функции.
Для этого элементарным преобразованием занулим оценку замещения, соответствующую $x_1$.

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после первой итерации}
\begin{tabular}{|c|cccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$\\
\hline
$-\mathbf{c}_{\mathcal{B}_1}^{\top}\bx_{\mathcal{B}_1} = 100$ & $0$ & $-7$ & $-2$ & $0$ & $5$ & $0$ \\
\hline
$x_4 = 10$ & 0 & $1.5$ & 1 & 1 & $-0.5$ & 0 \\
$x_1 = 10$ & 1 & $0.5$ & 1 & 0 & $0.5$ & 0 \\
$x_6 = 0$ & 0 & \textbf{1} & $-1$ & 0 & $-1$ & 1 \\
\hline
\end{tabular}
\label{tab::simplex1}
\end{table}

Далее выбираем столбец $x_2$, поскольку оценка замещения отрицательная и индекс минимален $(2 < 3)$.
Аналогично предыдущей итерации $u = \mathbf{a}_2$ и $\theta^* = 0$ при $\ell = 6$. 
Таким образом, заменяем $x_6$ на $x_2$ и ведущий элемент равен 1 (выделен жирным). 
Заметим, что текущее решение является вырожденным, так как $x_6 = 0$. 
Поэтому значение целевой функции не меняется при смене базиса. 
Зануляем оценку замещения для $x_2$ и строки в столбце $x_2$ кроме строки с ведущим элементом. 
Получили таблицу~\ref{tab::simplex2}.

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после второй итерации}
\begin{tabular}{|c|cccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$\\
\hline
$-\mathbf{c}_{\mathcal{B}_1}^{\top}\bx_{\mathcal{B}_1} = 100$ & $0$ & $0$ & $-9$ & $0$ & $-2$ & $7$ \\
\hline
$x_4 = 10$ & 0 & 0 & $\mathbf{2.5}$ & 1 & 1 & $-1.5$ \\
$x_1 = 10$ & 1 & 0 & $1.5$ & 0 & 1 & $-0.5$ \\
$x_2 = 0$ & 0 & 1 & $-1$ & 0 & $-1$ & 1 \\
\hline
\end{tabular}
\label{tab::simplex2}
\end{table}

Далее выбираем стобец $x_3$, так как его индекс минимален среди столбцов с отрицательной оценкой замещения.
Аналогично предыдущей итерации $\mathbf{u} = \mathbf{a}_3$ и $\theta^* = \frac{x_4}{u_1} = 4$ для $\ell = 4$.
Таким образом, заменяем $x_4$ на $x_3$.
Получим следующую таблицу~\ref{tab::simplex3}.

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после третьей итерации}
\begin{tabular}{|c|cccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$\\
\hline
$-\mathbf{c}_{\mathcal{B}_1}^{\top}\bx_{\mathcal{B}_1} = 136$ & $0$ & $0$ & $0$ & $3.6$ & $1.6$ & $1.6$ \\
\hline
$x_3 = 4$ & 0 & 0 & $1$ & $0.4$ & $0.4$ & $-0.6$ \\
$x_1 = 4$ & 1 & 0 & $0$ & $-$ & $-$ & $-$ \\
$x_2 = 4$ & 0 & 1 & $0$ & $0.4$ & $-0.6$ & $0.4$ \\
\hline
\end{tabular}
\label{tab::simplex3}
\end{table}

Поскольку все оценки замещения неотрицательны, то решение найдено и оно является оптимальным. 
Найденное решение соответствует $(x_1, x_2, x_3) = (4,4,4)$ и находится в первом столбце и последних $m = 3$ строках.
В первом столбце и $m+1$ строке с конца находится отрицательное значение значения целевой функции, то есть оптимальное значение равно $-136$.
Знаки $-$ в ячейках таблицы означают, что значения в этих ячейках неважны и их можно не считать.

\section{Задача 2}
В этой задаче показано, что симплекс-метод может зациклиться, и как это зацикливание может быть преодолено с помощью правила Бранда. 
Здесь описание переходов от таблицы к таблице не будет описано столь подробно как в предыдущем примере, поскольку они полностью аналогичны. 
Ведущий элемент на каждой итерации будет выделен жирно.
\begin{equation*}
\begin{split}
& \min_{\bx} -\frac{3}{4}x_1 + 20x_2 - \frac{1}{2}x_3 + 6x_4\\
\text{s.t. } & \frac{1}{4}x_1 - 8x_2 - x_3 + 9x_4 \leq 0\\
& \frac{1}{2}x_2 - 12x_2 - \frac{1}{2}x_3 + 3x_4 \leq 0\\
& x_3 \leq 1\\
& x_{1,2,3,4} \geq 0
\end{split}
\end{equation*}
Преобразуем эту задачу к канонической форме:
\begin{equation*}
\begin{split}
& \min_{\bx} -\frac{3}{4}x_1 + 20x_2 - \frac{1}{2}x_3 + 6x_4\\
\text{s.t. } & \frac{1}{4}x_1 - 8x_2 - x_3 + 9x_4 + x_5 = 0\\
& \frac{1}{2}x_2 - 12x_2 - \frac{1}{2}x_3 + 3x_4 + x_6 = 0\\
& x_3 + x_7 = 1\\
& x_{1,2,3,4,5,6,7} \geq 0
\end{split}
\end{equation*}
Аналогично предыдущему примеру начальная угловая точка $\bx_0 = (0,0,0,0, 0,0,1)$.
Ей соответствует таблица~\ref{tab::simplex_20}.

\begin{table}[!ht]
\centering
\caption{Изначальная таблица симплекс-метода}
\begin{tabular}{|c|ccccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$\\
\hline
$-\mathbf{c}_{\mathcal{B}}^{\top}\bx_{\mathcal{B}} = 0$ & $-3/4$ & $20$ & $-1/2$ & $6$ & $0$ & $0$ & $0$ \\
\hline
$x_5 = 0$ & $\mathbf{1/4}$ & $-8$ & $-1$ & $9$ & $1$ & $0$ & $0$ \\
$x_6 = 0$ & $1/2$ & $-12$ & $-1/2$ & $3$ & $0$ & $1$ & 0 \\
$x_7 = 1$ & 0 & 0 & $1$ & $0$ & $0$ & $0$ & 1 \\
\hline
\end{tabular}
\label{tab::simplex_20}
\end{table}

При проведении симплекс-метода индексы будем выбирать так:
\begin{itemize}
\item столбец ведущего элемета определяется минимальным значением оценки замещения
\item ведущий элемент определяется, как минимальный индекс, соответствующий $\theta^*$
\end{itemize}

\newpage

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после первой итерации}
\begin{tabular}{|c|ccccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$\\
\hline
$-\mathbf{c}_{\mathcal{B}}^{\top}\bx_{\mathcal{B}} = 0$ & $0$ & $-4$ & $-7/2$ & $33$ & $3$ & $0$ & $0$ \\
\hline
$x_1 = 0$ & $1$ & $-32$ & $-4$ & $36$ & $4$ & $0$ & $0$ \\
$x_6 = 0$ & $0$ & $\mathbf{4}$ & $3/2$ & $-15$ & $-2$ & $1$ & 0 \\
$x_7 = 1$ & 0 & 0 & $1$ & $0$ & $0$ & $0$ & 1 \\
\hline
\end{tabular}
\label{tab::simplex_21}
\end{table}

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после второй итерации}
\begin{tabular}{|c|ccccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$\\
\hline
$-\mathbf{c}_{\mathcal{B}}^{\top}\bx_{\mathcal{B}} = 0$ & $0$ & $0$ & $-2$ & $18$ & $1$ & $1$ & $0$ \\
\hline
$x_1 = 0$ & $1$ & $0$ & $\mathbf{8}$ & $-84$ & $-12$ & $8$ & $0$ \\
$x_2 = 0$ & $0$ & $1$ & $3/8$ & $-15/4$ & $-1/2$ & $1/4$ & 0 \\
$x_7 = 1$ & 0 & 0 & $1$ & $0$ & $0$ & $0$ & 1 \\
\hline
\end{tabular}
\label{tab::simplex_22}
\end{table}

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после третьей итерации}
\begin{tabular}{|c|ccccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$\\
\hline
$-\mathbf{c}_{\mathcal{B}}^{\top}\bx_{\mathcal{B}} = 0$ & $1/4$ & $0$ & $0$ & $-3$ & $-2$ & $3$ & $0$ \\
\hline
$x_3 = 0$ & $1/8$ & $0$ & $1$ & $-21/2$ & $-3/2$ & $1$ & $0$ \\
$x_2 = 0$ & $-3/64$ & $1$ & $0$ & $\mathbf{3/16}$ & $1/16$ & $-1/8$ & 0 \\
$x_7 = 1$ & $-1/8$ & 0 & $0$ & $21/2$ & $3/2$ & $-1$ & 1 \\
\hline
\end{tabular}
\label{tab::simplex_23}
\end{table}

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после четвёртой итерации}
\begin{tabular}{|c|ccccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$\\
\hline
$-\mathbf{c}_{\mathcal{B}}^{\top}\bx_{\mathcal{B}} = 0$ & $-1/2$ & $16$ & $0$ & $0$ & $-1$ & $1$ & $0$ \\
\hline
$x_3 = 0$ & $-5/2$ & $56$ & $1$ & $0$ & $\mathbf{2}$ & $-6$ & $0$ \\
$x_4 = 0$ & $-1/4$ & $16/3$ & $0$ & $1$ & $1/3$ & $-2/3$ & 0 \\
$x_7 = 1$ & $5/2$ & $-56$ & $0$ & $0$ & $-2$ & $6$ & 1 \\
\hline
\end{tabular}
\label{tab::simplex_24}
\end{table}

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после пятой итерации}
\begin{tabular}{|c|ccccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$\\
\hline
$-\mathbf{c}_{\mathcal{B}}^{\top}\bx_{\mathcal{B}} = 0$ & $-7/4$ & $44$ & $1/2$ & $0$ & $0$ & $-2$ & $0$ \\
\hline
$x_5 = 0$ & $-5/4$ & $28$ & $1/2$ & $0$ & $1$ & $-3$ & $0$ \\
$x_4 = 0$ & $1/6$ & $-4$ & $-1/6$ & $1$ & $0$ & $\mathbf{1/3}$ & 0 \\
$x_7 = 1$ & $0$ & $0$ & $1$ & $0$ & $0$ & $0$ & 1 \\
\hline
\end{tabular}
\label{tab::simplex_25}
\end{table}

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после шестой итерации}
\begin{tabular}{|c|ccccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$\\
\hline
$-\mathbf{c}_{\mathcal{B}}^{\top}\bx_{\mathcal{B}} = 0$ & $-3/4$ & $20$ & $-1/2$ & $6$ & $0$ & $0$ & $0$ \\
\hline
$x_5 = 0$ & $1/4$ & $-8$ & $-1$ & $9$ & $1$ & $0$ & $0$ \\
$x_6 = 0$ & $1/2$ & $-12$ & $-1/2$ & $3$ & $0$ & $1$ & 0 \\
$x_7 = 1$ & 0 & 0 & $1$ & $0$ & $0$ & $0$ & 1 \\
\hline
\end{tabular}
\label{tab::simplex_26}
\end{table}

Получили таблицу~\ref{tab::simplex_26}, в точности совпадающую с изначальной таблицей~\ref{tab::simplex_20}. 
Таким образом, следуя указанным правилам выбора ведущего элемента симплекс-метод никогда не остановится.

\subsection{Правило Бранда}

Теперь проведём итерации симплекс-метода, используя правило Бранда для выбора ведущего элемента.
Можно увидеть, что вплоть до таблицы~\ref{tab::simplex_24} последовательность шагов совпадает.
Поэтому рассмотрим таблицу~\ref{tab::simplex_24} с точки зрения правила Бранда.
В таблице~\ref{tab::simplex_24_2} красным отмечен ведущий элемент, выбор которого привёл к зацикливанию, а синим~--- ведущрий элемент, выбранный по правилу Бранда.
Покажем, что его использование приведёт к остановке симплекс-метода за конечное число шагов.

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после четвёртой итерации}
\begin{tabular}{|c|ccccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$\\
\hline
$-\mathbf{c}_{\mathcal{B}}^{\top}\bx_{\mathcal{B}} = 0$ & $-1/2$ & $16$ & $0$ & $0$ & $-1$ & $1$ & $0$ \\
\hline
$x_3 = 0$ & $-5/2$ & $56$ & $1$ & $0$ & {\color{red}{$\mathbf{2}$}} & $-6$ & $0$ \\
$x_4 = 0$ & $-1/4$ & $16/3$ & $0$ & $1$ & $1/3$ & $-2/3$ & 0 \\
$x_7 = 1$ & {\color{blue}{$\mathbf{5/2}$}} & $-56$ & $0$ & $0$ & $-2$ & $6$ & 1 \\
\hline
\end{tabular}
\label{tab::simplex_24_2}
\end{table}

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после пятой итерации по правилу Бранда}
\begin{tabular}{|c|ccccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$\\
\hline
$-\mathbf{c}_{\mathcal{B}}^{\top}\bx_{\mathcal{B}} = 1/5$ & $0$ & $24/5$ & $0$ & $0$ & $-7/5$ & $11/5$ & $1/5$ \\
\hline
$x_3 = 1$ & $0$ & $0$ & $1$ & $0$ & $0$ & $0$ & $1$ \\
$x_4 = 1/10$ & $0$ & $-4/15$ & $0$ & $1$ & $\mathbf{2/15}$ & $-1/15$ & $1/10$ \\
$x_1 = 2/5$ & $1$ & $-112/5$ & $0$ & $0$ & $-4/5$ & $12/5$ & $2/5$ \\
\hline
\end{tabular}
\label{tab::simplex_25_2}
\end{table}

\begin{table}[!ht]
\centering
\caption{Таблица симплекс-метода после шестой итерации по правилу Бранда}
\begin{tabular}{|c|ccccccc|}
\hline
& $x_1$ & $x_2$ & $x_3$ & $x_4$ & $x_5$ & $x_6$ & $x_7$\\
\hline
$-\mathbf{c}_{\mathcal{B}}^{\top}\bx_{\mathcal{B}} = 5/4$ & $0$ & $2$ & $0$ & $21/2$ & $0$ & $3/2$ & $5/4$ \\
\hline
$x_3 = 1$ & $0$ & $0$ & $1$ & $0$ & $0$ & $0$ & $1$ \\
$x_5 = 3/5$ & $0$ & $-8/5$ & $0$ & $6$ & $4/5$ & $-2/5$ & $3/5$ \\
$x_1 = 1$ & $1$ & $-24$ & $0$ & $6$ & $0$ & $2$ & $1$ \\
\hline
\end{tabular}
\label{tab::simplex_26_2}
\end{table}

Видно, что все оценки замещения неотрицательны, следовательны найдено решение исходной задачи: $\bx^* = (1, 0, 1, 0)$ и $f^* = -\frac{5}{4}$.


\section{Задача 3}

\begin{thebibliography}{9}

\bibitem{intro2lin} 
Dimitris Bertsimas and John N. Tsitsiklis. \emph{Introduction to linear optimization}, Belmont, MA: Athena Scientific, 1997, 5th edition

\end{thebibliography}
\end{document}

