\documentclass[12pt]{article}
\usepackage{myart}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage[T2A]{fontenc}
\usepackage{secdot}
\newtheorem{Def}{ Определение}
\begin{document}
\title{Семинар № 8 \\ 
<<Разные конусы и сопряжённые функции>>}
\author{Александр Катруца}
\date{\today}
\maketitle

%\section{Разбор промежуточной контрольной}
%Сначала несколько замечаний о прошедшей промежуточной контрольной.
%\begin{enumerate}
%\item Большинство написали все базовые определения и формулировки, и это уже неплохо. 
%Те, кто не написал, пожалуйста, непременно выучите это к экзамену.
%\item Почему-то почти никто не взялся сформулировать задачу проекции точки на вероятностный симплекс. 
%Симплекс~--- это множество вида $\left \{ \bx \in \bbR_+^n \; \middle | \; \sum\limits_{i=1}^n x_i = 1 \right \}$.
%В условии он был назван вероятностным, потому что $\bx$ можно интерпретировать как дискретное вероятностное распределение.
%И чтобы навести вас на определение симплекса, если вы его забыли.
%Таким образом, задача нахождения проекции точки $\by$ на вероятностный симплекс формулируется следующим образом:
%\begin{equation}
%\begin{split}
%&\min\limits_{\bx \in \bbR^n} \| \bx - \by \|_2\\
%\text{s.t. } & x_i \geq 0\\
%& \sum\limits_{i=1}^n x_i = 1
%\end{split}
%\end{equation}
%и является выпуклой, так как целевая функция выпукла на выпуклой области определения~--- симплексе.
%\item Далее, небольшое напоминание определения выпуклой задачи. 
%\begin{Def}
%Оптимизационная задача называется \emph{выпуклой}, если целевая функция является выпуклой на выпуклом допустимом множестве.
%\end{Def}
%\item В задаче про нормальный конус имелся в виду конус, с помощью которого опрелелялся условный субдифференциал. 
%Но за ответ про конус, заданный некоторой нормой, я снижал совсем немного.
%\item В задаче, где надо было проверить выпуклость множества, зависящего от параметра $t$, некоторые довольно мучительно, влоб, показали, что это множество пустое и поэтому выпуклое.
%Однако ожидалось, что вы заметите, что при фиксированном $t$~---  это множество~--- шар, а значит выпукло.
%А дальше надо было привести утверждение про выпуклость пересечения любого числа выпукых множеств.
%Про этот приём я упоминал на семинаре.
%\item В задаче про нахождение множества разделяющих плоскостей для заданной точки и множества, кажется, толкьо один человек правильно набросал путь решения. 
%А именно надо было нарисовать картинку (специально задача дана в 2D) и понять, что для каждой точки, лежащей на оси ординат, между <<углом>> множества и данной точкой существует свой набор разделябщих гиперплоскостей.
%То есть первый параметр~--- это точка на оси ординат, второй параметр~--- это множество угловых коэффициентов, которое зависит от первого параметра.
%Далее нужно было аккуратно провести вычисления предельных положения разделяющих гиперплоскостей и записать ответ.   
%\end{enumerate}
%
%В целом, у меня осталось скорее положительное впечатление от вашей работы, однако я уже упоминал, что дальше контрольные будут оцениваться строже.
%По крайней мере по отношению к тем, кто не может написать базовые определения курса.

\section{Конусы}
\subsection{Конус возможных направлений}
Надеюсь все помнят определение конуса, а также определение нормального конуса, данное в связи с понятим условного субдиференциала.
Помимо нормального конуса важным понятием для сдачи курса является множество, называемое \emph{конус возможных направлений}.
\begin{Def}
Конусом возможных направлений для множества $G \subset \bbR^n$ в точке $\bx_0 \in G$ будем называть такое множество $\Gamma(\bx_0 | G) = \{ \bs \in \bbR^n | \bx_0 + \alpha\bs \in G, \; 0 \leq \alpha \leq \overline{\alpha}(\bs) \}$, где $\overline{\alpha}(\bs) > 0$.
\end{Def}
Определение достаточно интуитивно, а именно есть точка $\bx_0 \in G$ и множество векторов с началом в этой точке, принадлежащих множеству $G$.
Такое множество векторов и образует конус возможных направлений.
Направления \emph{возможные}, так как они не выводят за пределы множества.
В частности, для выпуклого множества это определение можно переформулирвать в виде
\begin{Def}
Конусом возможных направлений для выпуклого множества $X \subset \bbR^n$ в точке $\bx_0 \in X$ будем называть такое множество $\Gamma(\bx_0 | X) = \{ \bs \in \bbR^n | \bs = \lambda (\bx - \bx_0), \; \lambda > 0, \forall \bx \in X \}$.
\end{Def}

Далее для вычисления конуса возможных направлений для множества $G$ заданного в виде
\begin{equation}
G = \{ \bx \in \bbR^n | \varphi_i(\bx) \leq 0, \; i = \overline{0,n-1}; \; \varphi_i(\bx) = \ba_i^{\T}\bx - b_i = 0, \; i = \overline{n, m} \},
\label{eq::G}
\end{equation}
где $\varphi_i(\bx), \; i = \overline{0,n-1}$~--- выпуклы и $G$ регулярно\footnote{То есть градиенты активных ограничений линейно незавиисмы.} воспользуемся следующим фактом, который легко устанавливается напрямую из определения.
Конус возможных направлений для множества~\eqref{eq::G} в точке $\bx_0$ задаётся в виде:
\begin{equation}
\Gamma(\bx_0|G) = \{ \bs \in \bbR^n | \nabla \varphi_i(\bx_0)^{\T} \bs \leq 0, i \in I, \ba^{\T}_i \bs = 0, i = \overline{n,m} \},
\label{eq::G_Gamma}
\end{equation}
$I = \{i: \varphi_i(\bx_0) = 0, \; i = \overline{0,n-1}\}$ и $\nabla \varphi_i(\bx) \in \partial \varphi_i(\bx)$.
Также получим выражение для сопряжённого конуса возможных направлений $\Gamma^*(\bx_0|G)$:
\begin{equation}
\Gamma^*(\bx_0|G) = \left \{ \bp \in \bbR^n \middle\rvert \bp = \sum\limits_{i = n}^m \lambda_i\ba_i - \sum\limits_{i \in I} \mu_i \nabla\varphi_i(\bx_0) \right \},
\label{eq::G_Gamma_dual}
\end{equation} 
где $\lambda_i \in \bbR$, $\mu_i \in \bbR_+$.
Соотношение~\eqref{eq::G_Gamma_dual} может быть получено напрямую из определения сопряжённого конуса.

\textbf{Упражнение.} Покажите, что выполнено равенство $\mathcal{N}(\bx_0|G) = -\Gamma^*(\bx_0|G)$.

\textbf{Задача} Найдите $\Gamma(\bx_0|G)$ и $\Gamma^*(\bx_0|G)$ из геометрических соображений и испольщуя формулы~\eqref{eq::G_Gamma},~\eqref{eq::G_Gamma_dual}:
\[
G = \{ \bx \in \bbR^2 | x_1^2 + 2x_2^2 \leq 3, \; x_1 + x_2 = 0 \}.
\]

\subsection{Касательный (контингентный) конус}
Ещё один конус, про который надо знать,~--- это \emph{касательный конус}.
Из названия не совсем очевидным образом следует формальное определение.
\begin{Def}
Касательным конусом к множеству $G$ в точке $\bx_0 \in \overline{G}$ называется следующее множество $T(\bx_0 |G) = \{ \lambda \bz | \lambda > 0, \; \exists \{\bx_k\} \subset G, \; \bx_k \rightarrow \bx_0, \bx_k \neq \bx_0, \; \lim\limits_{k \rightarrow \infty} \frac{\bx_k - \bx_0}{\|\bx_k - \bx_0\|_2} = \bz \}$
\end{Def}
То есть это множество направлений, по которым можно сойтись по последовательностям из внутренности $G$ к точке из границы $G$.

По аналогии с конусом возможных направлений рассмотрим как выглядит касательный конус для множества $G$:
\begin{equation}
G = \{\bx \in \bbR^n | \varphi_i(\bx) \leq 0, i = \overline{0, n-1} \; \varphi_i(\bx) = 0, i = \overline{n, m} \}.
\label{eq::G_tangent}
\end{equation}

Из определения явно следует, что касательный конус для множества $G$~\eqref{eq::G_tangent} записывается как
\[
T(\bx_0|G) = \{ \bz \in \bbR^n | \nabla \varphi^{\T}_i(\bx_0)\bz \leq 0, i \in I, \; \nabla \varphi^{\T}_i(\bx_0)\bz = 0, i = \overline{n,m} \}
\]
и соответствующий ему сопряжённый конус:
\[
T^*(\bx_0|G) = \left \{ \bp \in \bbR^n \middle| \bp = \sum\limits_{i = n}^m \lambda_i \nabla \varphi_i(\bx_0) - \sum\limits_{i \in I} \mu_i \nabla \varphi_i(\bx_0) \right \},
\] 
где $\mu_i \in \bbR_+$, $\lambda_i \in \bbR$, $I = \{i | \varphi_i(\bx_0) = 0, i = \overline{0, n-1} \}$
Заметим, что для выпуклых множеств касательный конус совпадает с конусом возможных направлений.

\textbf{Пример}: найти $T(\bx_0|G)$ и $T^*(\bx_0|G)$ для множества $G = \{\bx \in \bbR^2 | x_1 + x_2 \leq 1, \; x^2_1 + 2x_2^2 = 1 \}$


\subsection{Острый экстремум}

Введём ещё один тип минимумов (экстремумов) функции.
\begin{Def}
Точка $\bx^* \in G$ является точкой острого минимума функции $f$ на множестве $G$, месли существует такое число $\gamma > 0$, что $f(\bx) - f(\bx^*) \geq \gamma \|\bx - \bx^*\|_2$ для всех $\bx \in G$.
\end{Def}

Определение неудобно для проверки точек минимума на остроту, поэтому сформулируем следующий факт.

\textbf{Факт об остром минимуме (максимуме):} пусть $f$ дифференцируемая функция на $G \subset \bbR^n$. 
Точка $\bx^* \in G$~--- точка острого минимума (максимума) функции $f$ на множестве $G$ тогда и только тогда, когда существует $\alpha > 0$ такое что $\nabla f^{\T}(\bx^*) h \geq \alpha > 0$ ($-\nabla f^{\T}(\bx^*) h \geq \alpha > 0$) для всех $h \in T(\bx^*)$ и $\|h\|_2 = 1$.  

\textbf{Пример}.
\begin{equation}
\begin{split}
& \min x_1^2 + x_2^2\\
\text{s.t. } & x_1^2 + 2x_2^2 = 2\\
& x_1 + x_2 \leq 1
\end{split}
\label{eq::sharp_extr}
\end{equation}

Будем решать задачу графически с помощью линий уровня.
Из картинки следует, что $\bx^*_1 = (0,1)$ и $\bx^*_2 = (0, -1)$~--- точки минимума и $f(\bx^*_{1,2}) = 1$, где $f$~--- целевая функция.
Найдём касательный конус для множества $G$ в этих точках.
На графике показано, что $T(\bx^*_1|G) = \left\{\lambda 
\begin{pmatrix}
-1\\
0
\end{pmatrix} 
\middle | \lambda \in \bbR_+
\right\}$
и $T(\bx^*_2|G) = \left\{\lambda 
\begin{pmatrix}
-1\\
0
\end{pmatrix} 
\middle | \lambda \in \bbR 
\right\}.$
Также прямое вычисление даёт $\nabla f(\bx^*_{1,2}) = 
\begin{pmatrix}
0\\
\pm 2
\end{pmatrix}.$
Из выражений для градиента целевой функции и векторов из касательных конусов в точках минимума, очевидно, что их скалярное произведение для точек $\bx^*_{1,2}$ равно нулю.
Таким образом, эти точки не являются точками острого экстремума.

Далее рассмотрим точки локального максимума $\bx^*_3 = (-\sqrt{2}, 0)$ и $\bx^*_4 = (4/3, -1/3)$.

\begin{itemize}
\item Точка $\bx^*_3$. 
В этой точке градиент целевой функции $\nabla f(\bx^*_3) = 
\begin{pmatrix}
-2\sqrt{2}\\
0
\end{pmatrix}
$
и касательный конус $T(\bx^*_3|G) = \left \{ \bp \middle| \bp = \lambda 
\begin{pmatrix}
1\\
0
\end{pmatrix} \;
, \;
\lambda \in \bbR \right\}
$
Скалярное произведение $\nabla f^{\T}(\bx^*_3)\bp$ может быть как положительным, так и отрицательным.
Следовательно, точка $\bx^*_3$ не является точкой острого экстремума.
\item Точка $\bx^*_4$. В этой точке $\nabla f(\bx^*_4) = \dfrac{2}{3}
\begin{pmatrix}
4\\
-1
\end{pmatrix}.  
$
Обозначим первое ограничение $\varphi_1(\bx) = 0$, а второе $\varphi_2(\bx) \leq 0$.
Тогда $\nabla \varphi_1(\bx^*_4) = \dfrac{4}{3} 
\begin{pmatrix}
2\\
-1
\end{pmatrix}
$ и $\nabla \varphi_2(\bx^*_4) = 
\begin{pmatrix}
1\\
1
\end{pmatrix}.
$
Тогда $T(\bx^*_4|G) = \{\bp \in \bbR^2 \; | \; p_1 + p_2 \leq 0, \; 2p_1 - p_2 = 0 \} = \left \{ \bp \in \bbR^2 \; \middle| \; \bp = \lambda \begin{pmatrix}
-1\\
-2
\end{pmatrix}, \; \lambda \in \bbR_+ \right\}.$
Определим для какой $\lambda$ выполнено $\|\bp\|_2 = 1$.
Элементарные вычисления дают $\lambda^* = \dfrac{1}{\sqrt{5}}$.
Тогда, используя факт об остром экстремуме для максимума, посчитаем скалярное произведение $\dfrac{2}{3}
\begin{pmatrix}
-4\\
1
\end{pmatrix}^{\T}
\dfrac{1}{\sqrt{5}} 
\begin{pmatrix}
-1\\
-2
\end{pmatrix} \geq 10^{-10} > 0
$
Таким образом, точка $\bx^*_4$ является точкой острого максимума.
\end{itemize}

\section{Сопряжённые функции}
Важным общематематическим понятием является понятие \emph{сопряжённой функции}. 
\begin{Def}
Пусть $f: \bbR^n \rightarrow \bbR$. 
Функция $f^*: \bbR^n \rightarrow \bbR$ называется сопряжённой функцией к функции $f$ и определена как
\vspace{-4mm}
\[
f^*(\by) = \sup\limits_{\bx \in dom \; f} (\by^{\T}\bx - f(\bx)).
\vspace{-3mm}
\]
Область определения $f^*$~--- это множество таких $\by$, что супремум конечен.
\end{Def}
Для нахождения сопряжённой функции необходимо задать её область определения, а затем оценить выражение под супремумом сверху.

Далее рассмотрим некоторые примеры.

\textbf{Пример 1.}

Найти сопряжённую функцию к функции $f(x) = ax + b$.

\textbf{Решение.}

По опредедению $f^*(y) = \sup\limits_{x \in \bbR} (yx - ax - b) = \sup\limits_{x \in \bbR} ((y - a)x - b)$. Под супремумом стоит линейная функцию по $x$, которая ограничена только при $y = a$. 
Следовательно, областью определения сопряжённой функции $f^*$ является одна точка $\{ a\}$, и значение сопряжённой функции в этой точке равно $f^*(a) = -b$.

\textbf{Пример 2.}
   
Найти сопряжённую функцию к функции $f(x) = x\log x$ при $x > 0$.

\textbf{Решение.}

Аналогично предыдущему примеру: $f^*(y) = \sup\limits_{x > 0} (xy - xlog x)$. 
Функция под супремумом ограничена сверху на области определения при любом $y$ (проверьте!). 
Поэтому областью определения $f^*$ является $\bbR$.
Найдём максимум из условия первого порядка: $g'(x) = y - \log x - 1 = 0$.
Откуда $x^* = e^{y - 1}$ и $f^*(y) = ye^{y-1} - e^{y-1}(y-1) = e^{y-1}$.

\textbf{Пример 3.}

Найти сопряжённую функцию к функции $f(\bx) = \|\bx\|$.

\textbf{Решение.}

По традиции рассмотрим определение $f^*(\by) = \sup\limits_{\bx \in \bbR^n} (\by^{\T}\bx - \| \bx\|)$.
Вспомним (или узнаем), что двойственная норма $\|\cdot \|_*$ определяется как $\|\bz\|_* = \sup\limits_{\| \bx \| \leq 1} (\bz^{\T}\bx)$. 
Напрямую из определения следует, что для всех $\bx$ и $\bz$ выполнено неравенство $\bz^{\T}\bx \leq \|\bx\| \|\bz\|_*$.
Если $\|\by\|_* > 1$, тогда существует вектор $\bz$ такой что $\bz^{\T}\by > 1$.
Возьмём $\bx = t\bz$ при $t \rightarrow \infty$ и получим неограниченность функции под супремумом:
\[
\by^{\T}\bx - \| \bx\| = t (\by^{\T}\bz - \|\bz\|) \rightarrow \infty
\] 
Наоборот, если $\|\by\|_* \leq 1$, тогда $\by^{\T}\bx \leq \| \bx \| \| \by \|_*$ и $ \by^{\T}\bx \leq \| \bx \|$. 
Значит функция под супремумом ограничена сверху 0 и достигается на нулевом векторе.
Таким образом,
\[
f^*(\by) = 
\begin{cases}
0 & \|\by\|_* \leq 1\\
\infty, & \text{otherwise}.
\end{cases}
\]
\end{document}